\section{Introduction}\label{sec:intro}

Population health research is becoming increasingly based on data-driven methods
(as opposed to those designed solely by clinical experts) for patient-centred
care through the advent of accessible software and a relative abundance of
electronic data. To better understand the needs and behaviours of a population,
it can be helpful to find an appropriate segmentation of that population; such a
segmentation allows for finer-grained analysis of groups in the population that
share some form of homogeneity. One commonly used method for such
patient-centred analysis is that of patient flow and their interaction with the
healthcare system.

However, this process relies heavily on detailed data --- about both the system
and the population within that system --- which may limit research where
sophisticated data pipelines are not yet in place. This work demonstrates how
this issue may be overcome using administrative, spell-level hospital data to
build a patient clustering that feeds into a multi-class queuing model.
Specifically, this work examines patient records from the NHS Wales Cwm Taf
Morgannwg University Health Board (UHB) that present chronic obstructive
pulmonary disease (COPD). COPD is of particular interest to Cwm Taf Morgannwg as
it was found that they had the highest prevalence of the condition across all
the Welsh health boards in an internal report by NHS Wales.

% TODO No reference for graph sent by Kendal but is this alright?

% TODO Image of process: administrative data -> extract service parameters ->
%                        validate parameters with Wasserstein distance ->
%                        continue with queuing model as normal

\subsection{Literature review}\label{subsec:review}

Clustering is the process of separating the instances of a dataset into distinct
parts to maximise homogeneity within each cluster and heterogeneity
between each cluster. Within healthcare, and particularly population health,
this concept has many applications. When applying this to a population, some
form of patient corpus is considered the \emph{de facto} dataset but the choice
of characteristics with which to describe a patient or record remains
open. The review for this work identified three groups of characteristics used
to cluster a patient population: a patient's system utilisation metrics, their
clinical attributes and their pathway. The first two encompass a method known as
segmentation analysis wherein a population is segmented in a straightforward
sense. The latter, however, does not strictly segment the patients directly
but rather groups their movements through a healthcare system via process
mining.~\cite{AG2018}~and~\cite{DDGM+12015} demonstrate how this technique can
help to improve the efficiency of a hospital system rather than tackling the
issue of patient-centred care as is the focus of this work.

% TODO Brief literature review of:
%       - clustering patient corpus
%       - reverse-engineering model parameters in healthcare ???
%       - queuing in healthcare

\subsection{Cluster analysis}\label{subsec:clusters}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{%
        \input{tex/summary.tex}
    }\caption{A summary of patient-level clinical attributes and disease
    prevalence by cluster and by population}\label{tab:summary}
\end{table}

\begin{figure}
    \centering
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{cluster_los}
        \caption{}\label{fig:cluster_los}
    \end{subfigure}\hfill%
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{intervention_los}
        \caption{}\label{fig:intervention_los}
    \end{subfigure}
    \caption{%
        Kernel density estimate plots for length of stay by
        (\subref{fig:cluster_los}) cluster and (\subref{fig:intervention_los})
        intervention
    }\label{fig:los_kde}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{cluster_wimd}
        \caption{}\label{fig:cluster_wimd}
    \end{subfigure}\hfill%
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{intervention_wimd}
        \caption{}\label{fig:intervention_wimd}
    \end{subfigure}
    \caption{%
        Histograms for WIMD by (\subref{fig:cluster_wimd}) cluster and
        (\subref{fig:intervention_wimd}) intervention
    }\label{fig:wimd_hist}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{cluster_n_icds}
        \caption{}\label{fig:cluster_n_icds}
    \end{subfigure}\hfill%
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{intervention_n_icds}
        \caption{}\label{fig:intervention_n_icds}
    \end{subfigure}
    \caption{%
        Histograms for number of ICDs by (\subref{fig:cluster_n_icds}) cluster
        and (\subref{fig:intervention_n_icds}) intervention
    }\label{fig:n_icds_hist}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{cluster_charlson_gross}
        \caption{}\label{fig:cluster_charlson}
    \end{subfigure}\hfill%
    \begin{subfigure}{\halfimgwidth}
        \includegraphics[width=\linewidth]{intervention_charlson_gross}
        \caption{}\label{fig:intervention_charlson}
    \end{subfigure}
    \caption{%
        Histograms for CCI by (\subref{fig:cluster_charlson}) cluster and
        (\subref{fig:intervention_charlson}) intervention
    }\label{fig:charlson_hist}
\end{figure}


% TODO Condensed analysis of clustering
%       - choosing k and a clustering algorithm
%       - comparison with treatment segmentation
